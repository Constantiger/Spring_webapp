<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin panel</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
        main {
            max-width: 600px;
            margin: 100px auto 0px;
        }

        main form > legend {
            text-align: center;
            margin-bottom: 15px;
        }

        main form fieldset {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }

        main form fieldset legend {
            font-size: 17px;
        }

        main form input {
            margin-left: 15px;
        }

        main .users-info {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <main>
        <section class="create-user" id="create-user">
            <form>
                <legend>Cоздание пользователя</legend>
                <fieldset>
                    <legend>Основные данные</legend>
                    <label>
                        <input type="text" placeholder="Логин" class="form-control" name="login" required >
                    </label>
                    <label>
                        <input type="current-password" class="form-control" placeholder="Пароль" name="password" required>
                    </label>
                    </fieldset>
                <fieldset>
                    <legend>Статус пользователя</legend>
                    <label>
                        <input type="radio" name="status" checked>
                        Обычный пользователь
                    </label>
                    <label>
                        <input type="radio" name="status">
                        Администратор
                    </label>
                </fieldset>
                <button type="submit" class="btn btn-primary">Создать пользователя</button>
            </form>
        </section>
        <section class="users-info">
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Логин</th>
                    <th scope="col">Пароль</th>
                    <th scope="col">Удалить</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">1</th>
                    <td>qwerty</td>
                    <td>123</td>
                    <td><button class="btn btn-outline-dark">DELETE</button></td>
                </tr>
                <tr>
                    <th scope="row">2</th>
                    <td>notQwerty</td>
                    <td>56789</td>
                    <td><button class="btn btn-outline-dark">DELETE</button></td>
                </tr>
                <tr>
                    <th scope="row">3</th>
                    <td>veryNotQwerty</td>
                    <td>jasdASDHJK</td>
                    <td><button class="btn btn-outline-dark">DELETE</button></td>
                </tr>
                </tbody>
            </table>
        </section>
    </main>
    <script>
        const createUserForm = document.querySelector("#create-user");
        const sendNewUser = (path, requestBody) =>
            fetch(`/${path}`, {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            }).catch(response => alert(response))

        const submitButtonHandler = async event => {
            event.preventDefault();
            const username = document.querySelector("input[name=login]").value
            const password = document.querySelector("input[name=password]").value
            const [_, adminStatusCheckbox] = document.querySelectorAll("input[name=status]")
            const isAdmin = adminStatusCheckbox.checked
            const requestBody = {
                username,
                password
            }

            if (isAdmin) {
                await sendNewUser('admin', requestBody);
            } else {
                await sendNewUser('user', requestBody);
            }
        }
        createUserForm.addEventListener("submit", submitButtonHandler)
    </script>
</body>
</html>
